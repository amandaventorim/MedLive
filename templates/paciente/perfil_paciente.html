{% extends "base_paciente.html" %}
{% block conteudo %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/perfil_paciente.css">
{% endblock %}


    <!-- Seção Principal -->
    <section class="secao-perfil">
        <div class="container">
            <!-- Cabeçalho do Perfil -->
            <div class="cabecalho-perfil">
                <div class="row align-items-center">
                    <div class="col-md-3 text-center">
                        <div class="foto-perfil-container">
                            <div class="foto-perfil">
                                <img src="{{ usuario.foto if usuario.foto else '/static/img/user-default.png' }}" alt="Foto do perfil" class="foto-usuario">
                            </div>
                            <button class="botao-editar-foto" data-bs-toggle="modal" data-bs-target="#modalEditarFoto">
                                <i class="bi bi-camera"></i>
                            </button>
                        </div>
                    </div>
                    <div class="col-md-9">
                        <h1 class="mb-2">{{ usuario.nome }}</h1>
                        <p class="mb-2 opacity-75">
                            <i class="bi bi-calendar me-2"></i>
                            35 anos • Nascido em {{ usuario.dataNascimento }}
                        </p>
                        <p class="mb-3 opacity-75">
                            <i class="bi bi-geo-alt me-2"></i>
                            São Paulo, SP • 
                            <i class="bi bi-person-check me-2"></i>
                            Paciente desde Janeiro 2023
                        </p>
                        <!-- Plano ativo removido conforme solicitado -->
                    </div>
                </div>
            </div>

            <!-- Estatísticas -->
            <div class="estatisticas-paciente">
                <div class="stat-card">
                    <div class="stat-numero">12</div>
                    <div class="stat-label">Consultas Realizadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-numero">3</div>
                    <div class="stat-label">Médicos Consultados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-numero">8</div>
                    <div class="stat-label">Receitas Emitidas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-numero">2</div>
                    <div class="stat-label">Anos Conosco</div>
                </div>
            </div>

            <div class="row">
                <!-- Informações Pessoais -->
                <div class="col-lg-8 mb-4">
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <span>
                                <i class="bi bi-person icone-secao"></i>
                                Informações Pessoais
                            </span>
                            <button class="btn botao-secundario btn-sm" onclick="editarSecao('pessoais')">
                                <i class="bi bi-pencil me-1"></i>
                                Editar
                            </button>
                        </h3>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="campo-perfil">
                                    <label class="label-campo">Nome Completo</label>
                                    <div class="valor-campo" id="nome">{{ usuario.nome }}</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="campo-perfil">
                                    <label class="label-campo">Email</label>
                                    <div class="valor-campo" id="email">{{ usuario.email }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="campo-perfil">
                                    <label class="label-campo">Telefone</label>
                                    <div class="valor-campo" id="telefone">(11) 98765-4321</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="campo-perfil">
                                    <label class="label-campo">Data de Nascimento</label>
                                    <div class="valor-campo" id="nascimento">15/03/1989</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="campo-perfil">
                                    <label class="label-campo">CPF</label>
                                    <div class="valor-campo" id="cpf">123.456.789-00</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="campo-perfil">
                                    <label class="label-campo">Estado Civil</label>
                                    <div class="valor-campo" id="estado_civil">Casado</div>
                                </div>
                            </div>
                        </div>

                        <div class="campo-perfil">
                            <label class="label-campo">Endereço</label>
                            <div class="valor-campo" id="endereco">Rua das Palmeiras, 456 - Jardins, São Paulo - SP, 01234-567</div>
                        </div>
                    </div>

                    <!-- Informações Médicas -->
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <span>
                                <i class="bi bi-heart-pulse icone-secao"></i>
                                Informações Médicas
                            </span>
                            <button class="btn botao-secundario btn-sm" onclick="editarSecao('medicas')">
                                <i class="bi bi-pencil me-1"></i>
                                Editar
                            </button>
                        </h3>

                        <div class="alerta-saude">
                            <i class="bi bi-exclamation-triangle"></i>
                            <div>
                                <strong>Atenção:</strong> Consulta de rotina agendada para 20/02/2025
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="info-medica-item">
                                    <span class="label-info">Tipo Sanguíneo:</span>
                                    <span class="valor-info">O+</span>
                                </div>
                                <div class="info-medica-item">
                                    <span class="label-info">Altura:</span>
                                    <span class="valor-info">1,89 m</span>
                                </div>
                                <div class="info-medica-item">
                                    <span class="label-info">Peso:</span>
                                    <span class="valor-info">80 kg</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-medica-item">
                                    <span class="label-info">IMC:</span>
                                    <span class="valor-info">22,8 (Normal)</span>
                                </div>
                                <div class="info-medica-item">
                                    <span class="label-info">Pressão Arterial:</span>
                                    <span class="valor-info">120/80 mmHg</span>
                                </div>
                                <div class="info-medica-item">
                                    <span class="label-info">Última Consulta:</span>
                                    <span class="valor-info">15/01/2025</span>
                                </div>
                            </div>
                        </div>

                        <div class="mt-3">
                            <label class="label-campo">Alergias</label>
                            <div class="valor-campo">Penicilina, Frutos do mar</div>
                        </div>

                        <div class="mt-3">
                            <label class="label-campo">Condições Médicas</label>
                            <div class="valor-campo">Hipertensão leve (controlada)</div>
                        </div>
                    </div>

                    <!-- Medicamentos Atuais -->
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <span>
                                <i class="bi bi-capsule icone-secao"></i>
                                Medicamentos Atuais
                            </span>
                            <button class="btn botao-secundario btn-sm">
                                <i class="bi bi-plus me-1"></i>
                                Adicionar
                            </button>
                        </h3>

                        <div class="medicamento-item">
                            <div class="nome-medicamento">Losartana 50mg</div>
                            <div class="dosagem-medicamento">1 comprimido pela manhã • Prescrito por Dr. João Silva</div>
                        </div>

                        <div class="medicamento-item">
                            <div class="nome-medicamento">Vitamina D3 2000UI</div>
                            <div class="dosagem-medicamento">1 cápsula ao dia • Prescrito por Dr. João Silva</div>
                        </div>

                        <div class="medicamento-item">
                            <div class="nome-medicamento">Ômega 3 1000mg</div>
                            <div class="dosagem-medicamento">1 cápsula após o almoço • Suplemento</div>
                        </div>
                    </div>

                    <!-- Histórico de Consultas -->
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <span>
                                <i class="bi bi-clock-history icone-secao"></i>
                                Histórico de Consultas
                            </span>
                            <a href="/minhas_consultas" class="btn botao-secundario btn-sm">
                                <i class="bi bi-eye me-1"></i>
                                Ver Todas
                            </a>
                        </h3>

                        <div class="historico-item">
                            <div class="icone-historico">
                                <i class="bi bi-heart-pulse"></i>
                            </div>
                            <div class="info-historico">
                                <div class="titulo-historico">Consulta Cardiológica</div>
                                <div class="data-historico">15 de Janeiro de 2025 • Dr. Sérgio Ribeiro</div>
                            </div>
                            <span class="status-historico status-concluido">Concluída</span>
                        </div>

                        <div class="historico-item">
                            <div class="icone-historico">
                                <i class="bi bi-calendar-check"></i>
                            </div>
                            <div class="info-historico">
                                <div class="titulo-historico">Consulta de Rotina</div>
                                <div class="data-historico">20 de Fevereiro de 2025 • Dr. Pedro Santorini</div>
                            </div>
                            <span class="status-historico status-agendado">Agendada</span>
                        </div>

                        <div class="historico-item">
                            <div class="icone-historico">
                                <i class="bi bi-eye"></i>
                            </div>
                            <div class="info-historico">
                                <div class="titulo-historico">Consulta Oftalmológica</div>
                                <div class="data-historico">10 de Dezembro de 2024 • Dra. Ana Costa</div>
                            </div>
                            <span class="status-historico status-concluido">Concluída</span>
                        </div>

                        <div class="historico-item">
                            <div class="icone-historico">
                                <i class="bi bi-x-circle"></i>
                            </div>
                            <div class="info-historico">
                                <div class="titulo-historico">Consulta Dermatológica</div>
                                <div class="data-historico">05 de Dezembro de 2024 • Dr. Carlos Lima</div>
                            </div>
                            <span class="status-historico status-cancelado">Cancelada</span>
                        </div>
                    </div>
                </div>

                <!-- Painel Lateral -->
                <div class="col-lg-4">
                    <!-- Contato de Emergência -->
                    <div class="contato-emergencia" style="background-color: linear-gradient(135deg, #B31D1D 0%, #8f1419 100%);">
                        <h4>
                            <i class="bi bi-telephone-fill me-2"></i>
                            Emergência 24h
                        </h4>
                        <div class="numero-emergencia">0800 123 4567</div>
                        <div>Atendimento médico de urgência</div>
                    </div>

                    <!-- Configurações de Conta -->
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <i class="bi bi-gear icone-secao"></i>
                            Configurações
                        </h3>

                        <div class="d-grid gap-2">
                            <button class="btn botao-medlive" data-bs-toggle="modal" data-bs-target="#modalAlterarSenha">
                                <i class="bi bi-lock me-2"></i>
                                Alterar Senha
                            </button>
                            <button class="btn botao-secundario">
                                <i class="bi bi-bell me-2"></i>
                                Notificações
                            </button>
                            <button class="btn botao-secundario">
                                <i class="bi bi-shield-check me-2"></i>
                                Privacidade
                            </button>
                            <button class="btn botao-secundario">
                                <i class="bi bi-download me-2"></i>
                                Exportar Dados
                            </button>
                        </div>
                    </div>

                    <!-- Contatos de Emergência -->
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <i class="bi bi-person-lines-fill icone-secao"></i>
                            Contatos de Emergência
                        </h3>

                        <div class="historico-item">
                            <div class="icone-historico" style="background: linear-gradient(135deg, #001942 0%, #003366 100%);">
                                <i class="bi bi-person-fill"></i>
                            </div>
                            <div class="info-historico">
                                <div class="titulo-historico">Maria Coelho Silva</div>
                                <div class="data-historico">Esposa • (11) 99999-8888</div>
                            </div>
                        </div>

                        <div class="historico-item">
                            <div class="icone-historico" style="background: linear-gradient(135deg, #001942 0%, #003366 100%);">
                                <i class="bi bi-person-fill"></i>
                            </div>
                            <div class="info-historico">
                                <div class="titulo-historico">Ana Santos</div>
                                <div class="data-historico">Mãe • (11) 98888-7777</div>
                            </div>
                        </div>

                        <div class="text-center mt-3">
                            <button class="btn botao-secundario btn-sm">
                                <i class="bi bi-plus-circle me-2"></i>
                                Adicionar Contato
                            </button>
                        </div>
                    </div>

                    <!-- Ações Rápidas -->
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <i class="bi bi-lightning icone-secao"></i>
                            Ações Rápidas
                        </h3>

                        <div class="d-grid gap-2">
                            <a href="/buscar_medicos" class="btn botao-medlive">
                                <i class="bi bi-calendar-plus me-2"></i>
                                Agendar Consulta
                            </a>
                            <button class="btn botao-secundario">
                                <i class="bi bi-chat-dots me-2"></i>
                                Falar com Médico
                            </button>
                            <a href="/prontuario" class="btn botao-secundario">
                                <i class="bi bi-file-medical me-2"></i>
                                Ver Prontuário
                            </a>                        
                            <button class="btn botao-secundario">
                                <i class="bi bi-prescription2 me-2"></i>
                                Minhas Receitas
                            </button>
                        </div>
                    </div>

                    <!-- Próximas Consultas -->
                    <div class="cartao-secao">
                        <h3 class="titulo-secao">
                            <i class="bi bi-calendar-event icone-secao"></i>
                            Próximas Consultas
                        </h3>

                        <div class="historico-item">
                            <div class="icone-historico">
                                <i class="bi bi-calendar-check"></i>
                            </div>
                            <div class="info-historico">
                                <div class="titulo-historico">Consulta de Rotina</div>
                                <div class="data-historico">20/02/2025 às 14:00</div>
                            </div>
                        </div>

                        <div class="text-center mt-3">
                            <a href="/sala_espera" class="btn botao-medlive btn-sm">
                                <i class="bi bi-video me-2"></i>Entrar na Consulta
                            </a>                              
                        </div>

                        
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal Alterar Senha -->
    <div class="modal fade" id="modalAlterarSenha" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background: linear-gradient(135deg, #001942 0%, #003366 100%); color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-lock me-2"></i>
                        Alterar Senha
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formAlterarSenha">
                        <div class="mb-3">
                            <label class="form-label">Senha Atual</label>
                            <input type="password" id="senhaAtual" name="senha_atual" class="form-control campo-edicao" placeholder="Digite sua senha atual" required>
                            <div class="text-danger mt-1" id="erroSenhaAtual" style="display: none;"></div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Nova Senha</label>
                            <input type="password" id="novaSenha" name="nova_senha" class="form-control campo-edicao" placeholder="Digite a nova senha (mínimo 6 caracteres)" required minlength="6">
                            <div class="text-danger mt-1" id="erroNovaSenha" style="display: none;"></div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Confirmar Nova Senha</label>
                            <input type="password" id="confirmarSenha" name="confirmar_senha" class="form-control campo-edicao" placeholder="Confirme a nova senha" required>
                            <div class="text-danger mt-1" id="erroConfirmarSenha" style="display: none;"></div>
                        </div>
                        <div class="alert alert-danger mt-2" id="erroGeral" style="display: none;"></div>
                        <div class="alert alert-success mt-2" id="sucessoSenha" style="display: none;"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn botao-secundario" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn botao-medlive" id="btnAlterarSenha">
                        <span class="btn-text">Alterar Senha</span>
                        <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Editar Foto -->
    <div class="modal fade" id="modalEditarFoto" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background: linear-gradient(135deg, #001942 0%, #003366 100%); color: white;">
                    <h5 class="modal-title">
                        <i class="bi bi-camera me-2"></i>
                        Alterar Foto do Perfil
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="foto-perfil mx-auto mb-3" style="width: 120px; height: 120px; font-size: 3rem;">
                        <img src="{{ usuario.foto if usuario.foto else '/static/img/user-default.png' }}" alt="Foto do perfil" class="foto-usuario">
                    </div>
                    
                    <form action="/perfil/alterar-foto" method="post" enctype="multipart/form-data" id="form-alterar-foto">
                        <div class="mb-3">
                            <label for="foto" class="form-label">Selecionar Nova Foto</label>
                            <input type="file" class="form-control campo-edicao" id="foto" name="foto" accept="image/*" required>
                        </div>
                        <p class="text-muted">Formatos aceitos: JPG, PNG, GIF, WEBP (máx. 5MB)</p>

                        
                        <div class="modal-footer">
                            <button type="button" class="btn botao-secundario" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn botao-medlive">Salvar Foto</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    
    
{% block extra_js %}
<script defer src="/static/js/perfil_paciente.js"></script>


{% endblock %}

{% endblock %}


