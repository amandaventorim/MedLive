{% extends "base_admin.html" %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/dashboard_administrador.css">
{% endblock %}

{% block conteudo %}
<section class="dashboard-section">
        <div class="container">
            <!-- Welcome Card -->
            <div class="welcome-card">
                <div class="row align-items-center">
                    <div class="col-md-12">
                        <h2 class="fw-bold mb-2">Olá, {{ usuario.nome }}!</h2>
                        <p class="mb-3">Gerencie todo o sistema MedLive. Você tem {{ medicos|length }} médicos ativos, {{ pacientes|length }} pacientes cadastrados e {{ especialidades|length }} especialidades disponíveis.</p>
                        <a href="#" class="btn btn-light fw-bold" onclick="mostrarSecao('medicos')">
                            <i class="bi bi-gear me-2"></i>Gerenciar Sistema
                        </a>
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="row g-4 mb-4">
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="stats-icon primary">
                            <i class="bi bi-person-badge"></i>
                        </div>
                        <h3 class="fw-bold text-azul mb-1">{{ medicos|length }}</h3>
                        <p class="text-secondary mb-0">Médicos Ativos</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="stats-icon success">
                            <i class="bi bi-people"></i>
                        </div>
                        <h3 class="fw-bold text-azul mb-1">{{ pacientes|length }}</h3>
                        <p class="text-secondary mb-0">Pacientes Cadastrados</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="stats-icon warning">
                            <i class="bi bi-heart-pulse"></i>
                        </div>
                        <h3 class="fw-bold text-azul mb-1">{{ especialidades|length }}</h3>
                        <p class="text-secondary mb-0">Especialidades</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stats-card">
                        <div class="stats-icon danger">
                            <i class="bi bi-shield-check"></i>
                        </div>
                        <h3 class="fw-bold text-azul mb-1">{{ administradores|length }}</h3>
                        <p class="text-secondary mb-0">Administradores</p>
                    </div>
                </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="admin-tabs mb-4">
                <button class="tab-button active" onclick="mostrarSecao('medicos')">
                    <i class="bi bi-person-badge me-2"></i>Médicos
                </button>
                <button class="tab-button" onclick="mostrarSecao('pacientes')">
                    <i class="bi bi-people me-2"></i>Pacientes
                </button>
                <button class="tab-button" onclick="mostrarSecao('especialidades')">
                    <i class="bi bi-heart-pulse me-2"></i>Especialidades
                </button>
                <button class="tab-button" onclick="mostrarSecao('administradores')">
                    <i class="bi bi-shield-check me-2"></i>Administradores
                </button>
            </div>

            <!-- Seção Médicos -->
            <div id="secao-medicos" class="admin-section active">
                <div class="section-header">
                    <h3><i class="bi bi-person-badge me-2"></i>Gerenciar Médicos</h3>
                    <a href="/cadastro_medico" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Cadastrar Médico
                    </a>
                </div>

                {% if medicos %}
                <div class="table-container">
                    <table class="table admin-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>CRM</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for medico in medicos %}
                            <tr>
                                <td>
                                    <div class="user-info">
                                        <div class="user-avatar">{{ medico.nome[:2].upper() }}</div>
                                        <div>
                                            <div class="user-name">{{ medico.nome }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td>{{ medico.crm }}</td>
                                <td>{{ medico.email }}</td>
                                <td><span class="status-badge status-ativo">{{ medico.statusProfissional or 'Ativo' }}</span></td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-action btn-view" title="Visualizar">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    Nenhum médico cadastrado ainda.
                </div>
                {% endif %}
            </div>

            <!-- Seção Pacientes -->
            <div id="secao-pacientes" class="admin-section">
                <div class="section-header">
                    <h3><i class="bi bi-people me-2"></i>Gerenciar Pacientes</h3>
                    <a href="/cadastro_paciente" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Cadastrar Paciente
                    </a>
                </div>

                {% if pacientes %}
                <div class="table-container">
                    <table class="table admin-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>CPF</th>
                                <th>Email</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for paciente in pacientes %}
                            <tr>
                                <td>
                                    <div class="user-info">
                                        <div class="user-avatar">{{ paciente.nome[:2].upper() }}</div>
                                        <div>
                                            <div class="user-name">{{ paciente.nome }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td>{{ paciente.cpf }}</td>
                                <td>{{ paciente.email }}</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-action btn-view" title="Visualizar">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    Nenhum paciente cadastrado ainda.
                </div>
                {% endif %}
            </div>

            <!-- Seção Especialidades -->
            <div id="secao-especialidades" class="admin-section">
                <div class="section-header">
                    <h3><i class="bi bi-heart-pulse me-2"></i>Gerenciar Especialidades</h3>
                    <a href="/gerenciar_especialidades" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Cadastrar Nova Especialidade
                    </a>
                </div>

                {% if especialidades %}
                <div class="row g-4">
                    {% for esp in especialidades[:6] %}
                    <div class="col-lg-4 col-md-6">
                        <div class="especialidade-card">
                            <div class="especialidade-icon">
                                <i class="bi bi-heart-pulse"></i>
                            </div>
                            <h5>{{ esp.nome }}</h5>
                            <p class="text-muted">{{ esp.descricao[:50] }}{% if esp.descricao|length > 50 %}...{% endif %}</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    Nenhuma especialidade cadastrada ainda. 
                    <a href="/gerenciar_especialidades" class="alert-link">Clique aqui para cadastrar.</a>
                </div>
                {% endif %}
            </div>

            <!-- Seção Administradores -->
            <div id="secao-administradores" class="admin-section">
                <div class="section-header">
                    <h3><i class="bi bi-shield-check me-2"></i>Gerenciar Administradores</h3>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalCadastroAdmin">
                        <i class="bi bi-plus-circle me-2"></i>Cadastrar Administrador
                    </button>
                </div>

                {% if administradores %}
                <div class="table-container">
                    <table class="table admin-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>CPF</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for admin in administradores %}
                            <tr>
                                <td>
                                    <div class="user-info">
                                        <div class="user-avatar">{{ admin.nome[:2].upper() }}</div>
                                        <div>
                                            <div class="user-name">{{ admin.nome }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td>{{ admin.email }}</td>
                                <td>{{ admin.cpf }}</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-action btn-view" title="Visualizar">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    Nenhum administrador cadastrado ainda.
                </div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Modais de Cadastro -->
    <!-- Modal Cadastro Médico -->
    <div class="modal fade" id="modalCadastroMedico" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Cadastrar Médico</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nome Completo</label>
                                    <input type="text" class="form-control">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">CRM</label>
                                    <input type="text" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Especialidade</label>
                                    <select class="form-select">
                                        <option>Cardiologia</option>
                                        <option>Dermatologia</option>
                                        <option>Neurologia</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary">Cadastrar</button>
                </div>
            </div>
        </div>
    </div>

</section>

{% endblock %}

{% block extra_js %}
<script src="/static/js/dashboard_administrador.js"></script>
{% endblock %}
